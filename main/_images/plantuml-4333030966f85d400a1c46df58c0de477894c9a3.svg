<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="1516px" preserveAspectRatio="none" style="width:1907px;height:1516px;background:#FFFFFF;" version="1.1" viewBox="0 0 1907 1516" width="1907px" zoomAndPan="magnify"><title>PTP data flow</title><defs/><g><rect fill="#F0F5F5" height="1346.4063" style="stroke:#181818;stroke-width:0.5;" width="1776.708" x="11" y="163.7813"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28.9771" x="884.8655" y="175.8481">ECU</text><rect fill="#E6FFE6" height="1326.2734" style="stroke:#181818;stroke-width:0.5;" width="381.2339" x="11" y="183.9141"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="71.4111" x="165.9114" y="195.981">ClientApp</text><rect fill="#B0C4DE" height="1326.2734" style="stroke:#181818;stroke-width:0.5;" width="465.3799" x="686.1353" y="183.9141"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="141.4829" x="848.0837" y="195.981">Time base provider</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="108.8691" x="897.6709" y="27.9951">PTP data flow</text><rect fill="#DDDDDD" height="95.4844" id="_legend" rx="7.5" ry="7.5" style="stroke:#000000;stroke-width:1;" width="183.5713" x="17" y="54.2969"/><rect fill="#F08080" height="16.2969" style="stroke:transparent;stroke-width:1;" width="13.3506" x="22" y="61.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="8.9004" x="22" y="74.292">&#160;&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="142.4199" x="39.8008" y="74.292">external ECU/Switch</text><rect fill="#ADD8E6" height="16.2969" style="stroke:transparent;stroke-width:1;" width="13.3506" x="22" y="77.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="13.3506" x="22" y="90.5889">&#160;&#160;&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73.7666" x="39.8008" y="90.5889">gptp stack</text><rect fill="#D3D3D3" height="16.2969" style="stroke:transparent;stroke-width:1;" width="13.3506" x="22" y="93.8906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="13.3506" x="22" y="106.8857">&#160;&#160;&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="75.5303" x="39.8008" y="106.8857">hw on ECU</text><rect fill="#90EE90" height="16.2969" style="stroke:transparent;stroke-width:1;" width="13.3506" x="22" y="110.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="8.9004" x="22" y="123.1826">&#160;&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.7051" x="39.8008" y="123.1826">mw stack</text><rect fill="#FFA07A" height="16.2969" style="stroke:transparent;stroke-width:1;" width="13.3506" x="22" y="126.4844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4502" x="22" y="139.4795">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84.5195" x="39.8008" y="139.4795">applications</text><line style="stroke:#000000;stroke-width:1;" x1="22" x2="195.5713" y1="61.2969" y2="61.2969"/><line style="stroke:#000000;stroke-width:1;" x1="22" x2="195.5713" y1="77.5938" y2="77.5938"/><line style="stroke:#000000;stroke-width:1;" x1="22" x2="195.5713" y1="93.8906" y2="93.8906"/><line style="stroke:#000000;stroke-width:1;" x1="22" x2="195.5713" y1="110.1875" y2="110.1875"/><line style="stroke:#000000;stroke-width:1;" x1="22" x2="195.5713" y1="126.4844" y2="126.4844"/><line style="stroke:#000000;stroke-width:1;" x1="22" x2="195.5713" y1="142.7813" y2="142.7813"/><line style="stroke:#000000;stroke-width:1;" x1="22" x2="22" y1="61.2969" y2="142.7813"/><line style="stroke:#000000;stroke-width:1;" x1="35.3506" x2="35.3506" y1="61.2969" y2="142.7813"/><line style="stroke:#000000;stroke-width:1;" x1="195.5713" x2="195.5713" y1="61.2969" y2="142.7813"/><g><title>Business logic</title><rect fill="transparent" height="1269.8438" width="8" x="68.0571" y="234.3438"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="71.5571" x2="71.5571" y1="234.3438" y2="1504.1875"/></g><g><title>score::time</title><rect fill="transparent" height="1269.8438" width="8" x="338.2393" y="234.3438"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="341.7393" x2="341.7393" y1="234.3438" y2="1504.1875"/></g><g><title>Shared resource (ipc)</title><rect fill="transparent" height="1269.8438" width="8" x="594.105" y="234.3438"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="597.605" x2="597.605" y1="234.3438" y2="1504.1875"/></g><g><title>Business logic</title><rect fill="transparent" height="1269.8438" width="8" x="743.1924" y="234.3438"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="746.6924" x2="746.6924" y1="234.3438" y2="1504.1875"/></g><g><title>libgptp</title><rect fill="transparent" height="1269.8438" width="8" x="1112.6074" y="234.3438"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1116.1074" x2="1116.1074" y1="234.3438" y2="1504.1875"/></g><g><title>OS</title><rect fill="transparent" height="1269.8438" width="8" x="1180.9683" y="234.3438"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1184.4683" x2="1184.4683" y1="234.3438" y2="1504.1875"/></g><g><title>Time Slave</title><rect fill="transparent" height="1269.8438" width="8" x="1482.0225" y="234.3438"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1485.5225" x2="1485.5225" y1="234.3438" y2="1504.1875"/></g><g><title>EMAC(eth)</title><rect fill="transparent" height="1269.8438" width="8" x="1736.1196" y="234.3438"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1739.6196" x2="1739.6196" y1="234.3438" y2="1504.1875"/></g><g><title>TimeMaster</title><rect fill="transparent" height="1269.8438" width="8" x="1848.4595" y="234.3438"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1851.9595" x2="1851.9595" y1="234.3438" y2="1504.1875"/></g><rect fill="#FFA07A" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="113.1143" x="15" y="203.0469"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="99.1143" x="22" y="223.042">Business logic</text><rect fill="#90EE90" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="92.9893" x="295.2446" y="203.0469"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78.9893" x="302.2446" y="223.042">score::time</text><rect fill="#90EE90" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="165.0605" x="515.0747" y="203.0469"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="151.0605" x="522.0747" y="223.042">Shared resource (ipc)</text><rect fill="#ADD8E6" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="113.1143" x="690.1353" y="203.0469"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="99.1143" x="697.1353" y="223.042">Business logic</text><rect fill="#ADD8E6" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="62.8154" x="1084.6997" y="203.0469"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="48.8154" x="1091.6997" y="223.042">libgptp</text><rect fill="#ADD8E6" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="33.9063" x="1167.5151" y="203.0469"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.9063" x="1174.5151" y="223.042">OS</text><rect fill="#ADD8E6" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="91.3965" x="1439.8242" y="203.0469"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77.3965" x="1446.8242" y="223.042">Time Slave</text><rect fill="#D3D3D3" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="88.1768" x="1695.5313" y="203.0469"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="74.1768" x="1702.5313" y="223.042">EMAC(eth)</text><rect fill="#F08080" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.5029" x="1803.708" y="203.0469"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.5029" x="1810.708" y="223.042">TimeMaster</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1895.2109" x="5" y="262.9102"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1900.2109" y1="262.9102" y2="262.9102"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1900.2109" y1="265.9102" y2="265.9102"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2;" width="185.4375" x="859.8867" y="252.3438"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="171.4375" x="865.8867" y="268.4106">Setup and Initialization</text><polygon fill="#181818" points="608.605,302.6094,598.605,306.6094,608.605,310.6094,604.605,306.6094" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="602.605" x2="745.6924" y1="306.6094" y2="306.6094"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.9736" x="614.605" y="301.5435">[01]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="51.6953" x="648.5786" y="301.5435">create()</text><polygon fill="#181818" points="329.7393,331.7422,339.7393,335.7422,329.7393,339.7422,333.7393,335.7422" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="71.5571" x2="335.7393" y1="335.7422" y2="335.7422"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.9736" x="78.5571" y="330.6763">[02]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="30.7036" x="112.5308" y="330.6763">init()</text><path d="M346.7393,319.6094 L346.7393,359.6094 L497.7393,359.6094 L497.7393,329.6094 L487.7393,319.6094 L346.7393,319.6094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M487.7393,319.6094 L487.7393,329.6094 L497.7393,329.6094 L487.7393,319.6094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130.3872" x="352.7393" y="336.6763">Create and initialize</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="73.3472" x="352.7393" y="351.8091">score::time</text><polygon fill="#181818" points="585.605,382.0078,595.605,386.0078,585.605,390.0078,589.605,386.0078" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="341.7393" x2="591.605" y1="386.0078" y2="386.0078"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.9736" x="348.7393" y="380.9419">[03]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="30.7036" x="382.7129" y="380.9419">init()</text><polygon fill="#181818" points="82.5571,411.1406,72.5571,415.1406,82.5571,419.1406,78.5571,415.1406" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="76.5571" x2="340.7393" y1="415.1406" y2="415.1406"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.9736" x="88.5571" y="410.0747">[04]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89.686" x="122.5308" y="410.0747">timebase ptr*</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1895.2109" x="5" y="443.707"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1900.2109" y1="443.707" y2="443.707"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1900.2109" y1="446.707" y2="446.707"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2;" width="163.1255" x="871.0427" y="433.1406"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="149.1255" x="877.0427" y="449.2075">PTP synchronization</text><path d="M1469.5225,470.2734 L1546.1465,470.2734 L1546.1465,477.4063 L1536.1465,487.4063 L1469.5225,487.4063 L1469.5225,470.2734 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="transparent" height="172.9297" style="stroke:#000000;stroke-width:1.5;" width="398.437" x="1469.5225" y="470.2734"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="31.624" x="1484.5225" y="483.3403">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="89.5415" x="1561.1465" y="482.4839">[every 125ms]</text><polygon fill="#181818" points="1496.5225,529.6719,1486.5225,533.6719,1496.5225,537.6719,1492.5225,533.6719" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="1839.9595,529.6719,1849.9595,533.6719,1839.9595,537.6719,1843.9595,533.6719" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="1490.5225" x2="1845.9595" y1="533.6719" y2="533.6719"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.9736" x="1502.5225" y="521.0396">[05]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97.5571" x="1536.4961" y="513.4731">Performing ptp</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100.5342" x="1536.4961" y="528.606">communication</text><line style="stroke:#181818;stroke-width:1;" x1="1485.5225" x2="1527.5225" y1="577.9375" y2="577.9375"/><line style="stroke:#181818;stroke-width:1;" x1="1527.5225" x2="1527.5225" y1="577.9375" y2="590.9375"/><line style="stroke:#181818;stroke-width:1;" x1="1486.5225" x2="1527.5225" y1="590.9375" y2="590.9375"/><polygon fill="#181818" points="1496.5225,586.9375,1486.5225,590.9375,1496.5225,594.9375,1492.5225,590.9375" style="stroke:#181818;stroke-width:1;"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.9736" x="1492.5225" y="565.3052">[06]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131.4473" x="1526.4961" y="557.7388">Calculation GM time</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123.646" x="1526.4961" y="572.8716">as per ptp protocol</text><polygon fill="#181818" points="1727.6196,631.2031,1737.6196,635.2031,1727.6196,639.2031,1731.6196,635.2031" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1485.5225" x2="1733.6196" y1="635.2031" y2="635.2031"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.9736" x="1492.5225" y="622.5708">[07]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145.2979" x="1526.4961" y="615.0044">Set synchronized time</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85.2998" x="1526.4961" y="630.1372">based on ptp</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1895.2109" x="5" y="677.7695"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1900.2109" y1="677.7695" y2="677.7695"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1900.2109" y1="680.7695" y2="680.7695"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2;" width="164.7505" x="870.2302" y="667.2031"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="150.7505" x="876.2302" y="683.27">Main Loop / Runtime</text><path d="M270.6289,704.3359 L347.2529,704.3359 L347.2529,711.4688 L337.2529,721.4688 L270.6289,721.4688 L270.6289,704.3359 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="transparent" height="515.7891" style="stroke:#000000;stroke-width:1.5;" width="1484.9907" x="270.6289" y="704.3359"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="31.624" x="285.6289" y="717.4028">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="81.8877" x="362.2529" y="716.5464">[every 50ms]</text><polygon fill="#181818" points="1104.1074,748.6016,1114.1074,752.6016,1104.1074,756.6016,1108.1074,752.6016" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="746.6924" x2="1110.1074" y1="752.6016" y2="752.6016"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.9736" x="753.6924" y="747.5356">[08]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="234.4761" x="787.666" y="747.5356">Read current synchronized ptp time</text><polygon fill="#181818" points="1473.5225,792.8672,1483.5225,796.8672,1473.5225,800.8672,1477.5225,796.8672" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1116.1074" x2="1479.5225" y1="796.8672" y2="796.8672"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.9736" x="1123.1074" y="784.2349">[09]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143.6538" x="1157.0811" y="776.6685">Use `devctl` to obtain</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="80.9136" x="1157.0811" y="791.8013">current time</text><path d="M741.2847,765.6016 L741.2847,790.6016 L1110.2847,790.6016 L1110.2847,775.6016 L1100.2847,765.6016 L741.2847,765.6016 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1100.2847,765.6016 L1100.2847,775.6016 L1110.2847,775.6016 L1100.2847,765.6016 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="348.8228" x="747.2847" y="782.6685">switch to kernel space and involve resource manager</text><polygon fill="#181818" points="1727.6196,837.1328,1737.6196,841.1328,1727.6196,845.1328,1731.6196,841.1328" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1485.5225" x2="1733.6196" y1="841.1328" y2="841.1328"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.9736" x="1492.5225" y="828.5005">[10]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101.4229" x="1526.4961" y="820.9341">Read time from</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91.9521" x="1526.4961" y="836.0669">EMAC register</text><polygon fill="#181818" points="1195.4683,866.2656,1185.4683,870.2656,1195.4683,874.2656,1191.4683,870.2656" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1189.4683" x2="1484.5225" y1="870.2656" y2="870.2656"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.9736" x="1201.4683" y="865.1997">[11]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="202.0903" x="1235.4419" y="865.1997">get current system (local) time</text><polygon fill="#181818" points="1473.5225,895.3984,1483.5225,899.3984,1473.5225,903.3984,1477.5225,899.3984" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="1184.4683" x2="1479.5225" y1="899.3984" y2="899.3984"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.9736" x="1191.4683" y="894.3325">[12]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138.7915" x="1225.4419" y="894.3325">Read local clock(TL0)</text><polygon fill="#181818" points="1496.5225,924.5313,1486.5225,928.5313,1496.5225,932.5313,1492.5225,928.5313" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="1490.5225" x2="1738.6196" y1="928.5313" y2="928.5313"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.9736" x="1502.5225" y="923.4653">[13]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="196.1235" x="1536.4961" y="923.4653">Synchronized ptp time 'Tptp0'</text><polygon fill="#181818" points="1127.1074,953.6641,1117.1074,957.6641,1127.1074,961.6641,1123.1074,957.6641" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="1121.1074" x2="1484.5225" y1="957.6641" y2="957.6641"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.9736" x="1133.1074" y="952.5981">[14]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="311.4414" x="1167.0811" y="952.5981">Current synchronized ptp time 'Tptp0' and 'TL0'</text><path d="M956.667,941.5313 L956.667,966.5313 L1110.667,966.5313 L1110.667,951.5313 L1100.667,941.5313 L956.667,941.5313 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1100.667,941.5313 L1100.667,951.5313 L1110.667,951.5313 L1100.667,941.5313 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133.4404" x="962.667" y="958.5981">switch to user space</text><polygon fill="#181818" points="757.6924,988.7969,747.6924,992.7969,757.6924,996.7969,753.6924,992.7969" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="751.6924" x2="1115.1074" y1="992.7969" y2="992.7969"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.9736" x="763.6924" y="987.731">[15]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="311.4414" x="797.666" y="987.731">Current synchronized ptp time 'Tptp0' and 'TL0'</text><polygon fill="#181818" points="1172.4683,1017.9297,1182.4683,1021.9297,1172.4683,1025.9297,1176.4683,1021.9297" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="746.6924" x2="1178.4683" y1="1021.9297" y2="1021.9297"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.9736" x="753.6924" y="1016.8638">[16]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="202.0903" x="787.666" y="1016.8638">get current system (local) time</text><polygon fill="#181818" points="757.6924,1047.0625,747.6924,1051.0625,757.6924,1055.0625,753.6924,1051.0625" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="751.6924" x2="1183.4683" y1="1051.0625" y2="1051.0625"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.9736" x="763.6924" y="1045.9966">[17]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118.644" x="797.666" y="1045.9966">current time (TL1)</text><line style="stroke:#181818;stroke-width:1;" x1="746.6924" x2="788.6924" y1="1080.1953" y2="1080.1953"/><line style="stroke:#181818;stroke-width:1;" x1="788.6924" x2="788.6924" y1="1080.1953" y2="1093.1953"/><line style="stroke:#181818;stroke-width:1;" x1="747.6924" x2="788.6924" y1="1093.1953" y2="1093.1953"/><polygon fill="#181818" points="757.6924,1089.1953,747.6924,1093.1953,757.6924,1097.1953,753.6924,1093.1953" style="stroke:#181818;stroke-width:1;"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.9736" x="753.6924" y="1075.1294">[18]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="244.6133" x="787.666" y="1075.1294">Validate ptp time and set status flags</text><path d="M419.1406,1064.0625 L419.1406,1134.0625 L741.1406,1134.0625 L741.1406,1074.0625 L731.1406,1064.0625 L419.1406,1064.0625 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M731.1406,1064.0625 L731.1406,1074.0625 L741.1406,1074.0625 L731.1406,1064.0625 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="301.5518" x="425.1406" y="1081.1294">Validation of ptp time using local clock ('TL2'):</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="152.7881" x="425.1406" y="1096.2622">1. Inaccuracy detection</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="211.3262" x="425.1406" y="1111.395">2. loosing data frames detection</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="200.7891" x="425.1406" y="1126.5278">3. verification for monotonicity</text><polygon fill="#181818" points="608.605,1156.7266,598.605,1160.7266,608.605,1164.7266,604.605,1160.7266" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="602.605" x2="745.6924" y1="1160.7266" y2="1160.7266"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.9736" x="614.605" y="1155.6606">[19]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="68.3198" x="648.5786" y="1155.6606">Write data</text><path d="M291.6289,1144.5938 L291.6289,1214.5938 L591.6289,1214.5938 L591.6289,1154.5938 L581.6289,1144.5938 L291.6289,1144.5938 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M581.6289,1144.5938 L581.6289,1154.5938 L591.6289,1154.5938 L581.6289,1144.5938 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="255.0552" x="297.6289" y="1161.6606">Store to shared resource received data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148.313" x="297.6289" y="1176.7935">1. last ptp time 'Tptp0'</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="279.9761" x="297.6289" y="1191.9263">2. local clock 'TL0', when ptp was read and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91.7935" x="297.6289" y="1207.0591">3. status flags</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1895.2109" x="5" y="1254.6914"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1900.2109" y1="1254.6914" y2="1254.6914"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1900.2109" y1="1257.6914" y2="1257.6914"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2;" width="125.5029" x="889.854" y="1244.125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="111.5029" x="895.854" y="1260.1919">Client use-case</text><polygon fill="#181818" points="329.7393,1294.3906,339.7393,1298.3906,329.7393,1302.3906,333.7393,1298.3906" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="71.5571" x2="335.7393" y1="1298.3906" y2="1298.3906"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.9736" x="78.5571" y="1293.3247">[20]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="204.0708" x="112.5308" y="1293.3247">Call ::Now() to read time status</text><polygon fill="#181818" points="585.605,1323.5234,595.605,1327.5234,585.605,1331.5234,589.605,1327.5234" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="341.7393" x2="591.605" y1="1327.5234" y2="1327.5234"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.9736" x="348.7393" y="1322.4575">[21]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66.6631" x="382.7129" y="1322.4575">Read data</text><polygon fill="#181818" points="352.7393,1352.6563,342.7393,1356.6563,352.7393,1360.6563,348.7393,1356.6563" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="346.7393" x2="596.605" y1="1356.6563" y2="1356.6563"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.9736" x="358.7393" y="1351.5903">[22]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="392.7129" y="1351.5903">&#160;</text><polygon fill="#181818" points="1172.4683,1381.7891,1182.4683,1385.7891,1172.4683,1389.7891,1176.4683,1385.7891" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="341.7393" x2="1178.4683" y1="1385.7891" y2="1385.7891"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.9736" x="348.7393" y="1380.7231">[23]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="202.0903" x="382.7129" y="1380.7231">get current system (local) time</text><polygon fill="#181818" points="352.7393,1410.9219,342.7393,1414.9219,352.7393,1418.9219,348.7393,1414.9219" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="346.7393" x2="1183.4683" y1="1414.9219" y2="1414.9219"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.9736" x="358.7393" y="1409.856">[24]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120.5737" x="392.7129" y="1409.856">Current time (TL2)</text><line style="stroke:#181818;stroke-width:1;" x1="341.7393" x2="383.7393" y1="1444.0547" y2="1444.0547"/><line style="stroke:#181818;stroke-width:1;" x1="383.7393" x2="383.7393" y1="1444.0547" y2="1457.0547"/><line style="stroke:#181818;stroke-width:1;" x1="342.7393" x2="383.7393" y1="1457.0547" y2="1457.0547"/><polygon fill="#181818" points="352.7393,1453.0547,342.7393,1457.0547,352.7393,1461.0547,348.7393,1457.0547" style="stroke:#181818;stroke-width:1;"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.9736" x="348.7393" y="1438.9888">[25]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="207.8921" x="382.7129" y="1438.9888">Adjust ptp time, with local clock</text><path d="M602.605,1427.9219 L602.605,1452.9219 L876.605,1452.9219 L876.605,1437.9219 L866.605,1427.9219 L602.605,1427.9219 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M866.605,1427.9219 L866.605,1437.9219 L876.605,1437.9219 L866.605,1427.9219 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="253.8872" x="608.605" y="1444.9888">current_ptp_time = Tptp0 + (Tl2 - TL0)</text><polygon fill="#181818" points="82.5571,1482.1875,72.5571,1486.1875,82.5571,1490.1875,78.5571,1486.1875" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="76.5571" x2="340.7393" y1="1486.1875" y2="1486.1875"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.9736" x="88.5571" y="1481.1216">[26]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="212.2085" x="122.5308" y="1481.1216">Adjusted ptp time and it's status</text><!--SRC=[dLRRRXit47tVhvWg3vBIsf5TE0yBou0Z1441kpKY9tse2uVYpagikSi5oPMYm1_V6UvTIeAqVh54dhcSCnTgenA4r1Y_Cf-ZI9JUv6MsGWkZozJa7gJHniuj9bUNgwk_PhE_Hr7abTS8T_Tta0Wl8DLc5qKQrvWdu4q16bCVFSFbYnkrtlY5iK9V0Jm3VlPeSw7XxUB3g-LEURa1Ek-WRtI9Ltm4wy8NuBoGJz3xwq7VMTnNqCqEJCukuTjGp4C2sUxOvm2w53epX7q6KHHQIU6LoLqVIXmhfb7qKs75EXFWqNm1RqkCI4COKIOZU97Eqelq8W88PmkjCFVNHK4t-3fDyNN4xWfXlPAg42Jqw4tfL8xEWJPh9KSW72S1_SIEZPmq5kFOgmo31J7iaIOyruHBUs2tt0YgALXqfhGIOQ8AEGqUtER0Go1mJm5W9Hn2OSsMUiQEcimyekR2_H0ZJZHvN3de2dvifzMAwnyCwiz3_3T8_R4C9kR0-m0JY2ors5Pw7ViUeD_UNYycw3ULD9W9sOcpZveqZWBS2kTP8RBf_8SvYABvV8c-B42GyM-vyafezINqsNmUjVASN74XOf0MXSV9DE9MeCDi5uCYAph9ZKUmx9coNWHSSAeQfyocrnyXNJQAg4c2_zOL7z09nuX3YQfAU_kIy-L1T_jSRgp9krIreKd7BTezd9rVP8wb8wwNx2Ye6iCTsjJOJELhldh8fScoCg-dYl01ri4NGijIXqjuTnloUCXPGjf6ZA3EyuRsKSyoL2G6KhIN8VLrPSii4buEX0xiEMTcT2jK3ZTCu1MyBtD63nbTp0AXVZcQHepXFOe4P6ajZVGmBDy7gQ65T_G-aAIV4jnAhp_HcWIpyfG6gL9xgWr3MSC6vRbmrPOa-1EjJjJW2Y6REc-Dtc8tmvd8nHfjFH-XqaTAXTmv4gJMP0yvDpXvM2jks1wSPYY6DSdQyIH41XDjfD3J9bc2zUeTd0S0IFhtDBc_cKqv7OxTuAXQNvCCnlVqSJPkSnX8llYUserfK6LCCSVVaR5qr4r1nA5ERRqeRbls_nEutpF_JSLUs7vF0CbuDZtmtCD-f5bFUFZRj3WTnoFXXIyTlSzYxOuagSrus4pQsVBANlUB21DYTZwUni7gx9IMbf2Kdv1xID2Zh8SPuFoK1opOLxyBhCZG7O1-FGMQC9NMMu1-UbYWbuqccnQ3yljXLOxsuPzM4GbsVqHewMdLSOdTmTjcKQBQqabj5bXeMj5VQxwQHaS_rFKNs6qmx17OqKQotEYaSiFeGEYMm63fLBy1k05F92qcMZZjJg-MduOu_jti9bCcOTj1hPotIxkPiq26lfu43_Nr3pLStMvLs8D6Ev_MdiBjTV9FsPE9L51-qrTd-0ZLGHy9_nWSpY7e2Z-JQtqE9n0Mmk0TQf-TAbP_kiAIysFNAF0l]--></g></svg>